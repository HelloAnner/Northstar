<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Northstar E2E (agent-browser) - PASS</title>
  <style>
    :root {
      --bg: #0b1220;
      --panel: #0f1b33;
      --text: #e6edf3;
      --muted: #a6b3c3;
      --ok: #4ade80;
      --bad: #fb7185;
      --warn: #fbbf24;
      --border: rgba(255,255,255,.10);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }
    body { margin: 0; background: var(--bg); color: var(--text); font-family: var(--sans); }
    .page { display: flex; align-items: flex-start; }
    .sidebar {
      position: sticky;
      top: 0;
      height: 100vh;
      width: 270px;
      flex: 0 0 270px;
      overflow: auto;
      padding: 18px 14px 18px;
      border-right: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(15,27,51,.92), rgba(11,18,32,.92));
      backdrop-filter: blur(10px);
    }
    .side-head { display: flex; align-items: center; justify-content: space-between; gap: 10px; margin-bottom: 12px; }
    .side-title { font-weight: 800; font-size: 13px; letter-spacing: .02em; color: var(--text); }
    .side-sub { color: var(--muted); font-size: 12px; margin-top: 2px; }
    .side-nav { display: flex; flex-direction: column; gap: 4px; margin-top: 10px; }
    .side-nav a {
      display: block;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid transparent;
      color: var(--text);
      font-size: 13px;
      line-height: 1.2;
    }
    .side-nav a:hover { background: rgba(255,255,255,.04); text-decoration: none; border-color: rgba(255,255,255,.10); }
    .side-nav a.active { background: rgba(147,197,253,.10); border-color: rgba(147,197,253,.25); }
    .side-nav .group { margin-top: 10px; padding: 8px 10px; color: var(--muted); font-size: 12px; font-weight: 800; letter-spacing: .04em; text-transform: uppercase; }
    .side-foot { margin-top: 14px; padding-top: 12px; border-top: 1px solid var(--border); color: var(--muted); font-size: 12px; }
    .side-foot a { color: #93c5fd; }
    .main { min-width: 0; flex: 1 1 auto; }
    .wrap { max-width: 1200px; margin: 0 auto; padding: 28px 18px 48px; }
    .title { display: flex; align-items: baseline; justify-content: space-between; gap: 12px; }
    h1 { font-size: 22px; margin: 0; }
    .pill { padding: 4px 10px; border-radius: 999px; font-weight: 700; font-size: 12px; border: 1px solid var(--border); }
    .pill.ok { color: #052e15; background: var(--ok); border-color: rgba(74,222,128,.35); }
    .pill.bad { color: #2b0b11; background: var(--bad); border-color: rgba(251,113,133,.35); }
    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 16px; }
    .card { background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 14px 14px 12px; }
    .card h2 { font-size: 14px; margin: 0 0 8px; color: var(--muted); font-weight: 700; }
    .kv { display: grid; grid-template-columns: 160px 1fr; gap: 6px 10px; font-size: 13px; }
    .kv div { padding: 2px 0; }
    .k { color: var(--muted); }
    .v { font-family: var(--mono); }
    .mono { font-family: var(--mono); }
    .ok { color: var(--ok); font-weight: 700; }
    .bad { color: var(--bad); font-weight: 700; }
    .warn { color: var(--warn); font-weight: 700; }
    .section { margin-top: 14px; }
    .section h3 { margin: 0 0 10px; font-size: 16px; }
    .h3line { display: flex; align-items: center; justify-content: space-between; gap: 10px; }
    .h3line a.permalink { font-family: var(--mono); font-size: 12px; color: var(--muted); }
    .h3line a.permalink:hover { color: #93c5fd; text-decoration: none; }
    a { color: #93c5fd; text-decoration: none; }
    a:hover { text-decoration: underline; }
    ul { margin: 8px 0 0 18px; }
    li { margin: 3px 0; }
    .table-wrap { overflow: auto; border: 1px solid var(--border); border-radius: 10px; }
    table { border-collapse: collapse; width: 100%; min-width: 900px; font-size: 12px; }
    th, td { border-bottom: 1px solid var(--border); padding: 8px 10px; text-align: left; vertical-align: top; }
    th { position: sticky; top: 0; background: rgba(15,27,51,.95); backdrop-filter: blur(8px); }
    .shots { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
    @media (max-width: 1100px) { .shots { grid-template-columns: repeat(3, 1fr); } }
    @media (max-width: 820px) { .shots { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 520px) { .shots { grid-template-columns: 1fr; } }
    .shot { border: 1px solid var(--border); border-radius: 10px; overflow: hidden; background: rgba(255,255,255,.02); }
    .shot img.thumb { width: 100%; height: 120px; object-fit: cover; display: block; }
    .shot .cap { padding: 8px 10px; font-size: 12px; color: var(--muted); }
    pre { background: rgba(255,255,255,.04); border: 1px solid var(--border); border-radius: 10px; padding: 10px 12px; overflow: auto; }

    .lightbox { position: fixed; inset: 0; background: rgba(0,0,0,.76); display: none; z-index: 9999; }
    .lightbox.open { display: block; }
    .lightbox-inner { position: absolute; inset: 28px 20px; display: grid; grid-template-rows: auto 1fr auto; gap: 10px; }
    .lightbox-top { display: flex; align-items: center; justify-content: space-between; gap: 10px; }
    .lightbox-title { color: var(--muted); font-size: 12px; font-family: var(--mono); }
    .lightbox-btn { border: 1px solid rgba(255,255,255,.18); background: rgba(255,255,255,.06); color: var(--text); border-radius: 10px; padding: 8px 10px; cursor: pointer; }
    .lightbox-btn:hover { background: rgba(255,255,255,.10); }
    .lightbox-body { position: relative; border: 1px solid rgba(255,255,255,.14); border-radius: 12px; overflow: hidden; background: rgba(0,0,0,.20); }
    .lightbox-body img { width: 100%; height: 100%; object-fit: contain; display: block; }
    .lightbox-nav { position: absolute; inset: 0; display: flex; align-items: center; justify-content: space-between; pointer-events: none; }
    .lightbox-nav button { pointer-events: all; width: 44px; height: 44px; border-radius: 999px; }
    .lightbox-bottom { color: var(--muted); font-size: 12px; font-family: var(--mono); }

    @media (max-width: 980px) {
      .page { display: block; }
      .sidebar {
        position: sticky;
        top: 0;
        height: auto;
        width: auto;
        border-right: none;
        border-bottom: 1px solid var(--border);
        padding: 12px 12px;
      }
      .side-nav { flex-direction: row; flex-wrap: nowrap; overflow-x: auto; padding-bottom: 6px; }
      .side-nav a { white-space: nowrap; }
      .side-nav .group { display: none; }
    }
  </style>
</head>
<body>
  <div class="page">
    <aside class="sidebar">
      <div class="side-head">
        <div>
          <div class="side-title">报告目录</div>
          <div class="side-sub mono">2026-01-31 20:12:30</div>
        </div>
        <div class="pill ok">PASS</div>
      </div>
      <nav class="side-nav" id="toc">
        <a href="#overview">总览</a>
        <a href="#steps">执行步骤</a>
        <a href="#completeness">明细完整性</a>
        <a href="#suggestions">改动建议</a>
        <div class="group">一致性</div>
        <a href="#import">导入一致性</a>
        <a href="#export">导出一致性</a>
        <div class="group">模板</div>
        <a href="#template">导出模板</a>
        <div class="group">日志</div>
        <a href="#import-log">导入日志</a>
        <a href="#browser-log">浏览器日志</a>
        <a href="#screenshots">关键截图</a>
        <a href="#conclusion">结论</a>
      </nav>
      <div class="side-foot">
        <div>复现入口：<span class="mono">http://localhost:20260</span></div>
        <div style="margin-top:6px;"><a href="#overview">回到顶部</a></div>
      </div>
    </aside>

    <main class="main">
      <div class="wrap" id="overview">
    <div class="title">
      <h1>Northstar E2E（agent-browser）</h1>
      <div class="pill ok">PASS</div>
    </div>
    <div class="section" id="overview-card">
      <div class="h3line">
        <h3>总览</h3>
        <a class="permalink" href="#overview-card">#</a>
      </div>
      <div class="grid">
        <div class="card">
          <h2>运行信息</h2>
          <div class="kv">
            <div class="k">时间</div><div class="v">2026-01-31 20:12:30</div>
            <div class="k">BASE_URL</div><div class="v">http://localhost:20260</div>
            <div class="k">输入 Excel</div><div class="v"><a href="/Users/anner/code/Northstar/prd/12月月报（预估）_补全企业名称社会代码_20260129.xlsx">/Users/anner/code/Northstar/prd/12月月报（预估）_补全企业名称社会代码_20260129.xlsx</a></div>
            <div class="k">导出 Excel</div><div class="v"><a href="latest/export.xlsx">latest/export.xlsx</a></div>
            <div class="k">抽取(导入后)</div><div class="v">2026-01-31T12:11:56.725Z</div>
            <div class="k">抽取(修改后)</div><div class="v">2026-01-31T12:12:18.627Z</div>
          </div>
        </div>
        <div class="card">
          <h2>附件</h2>
          <ul>
            <li><a class="mono" href="latest/ui_companies_before.json">ui_companies_before.json</a></li>
            <li><a class="mono" href="latest/ui_companies_after.json">ui_companies_after.json</a></li>
            <li><a class="mono" href="latest/import_events.json">import_events.json</a></li>
            <li><a class="mono" href="latest/tab_counts.json">tab_counts.json</a></li>
            <li><a class="mono" href="latest/browser_console.txt">browser_console.txt</a></li>
            <li><a class="mono" href="latest/browser_errors.txt">browser_errors.txt</a></li>
            <li><a class="mono" href="latest/trace.zip">trace.zip</a></li>
            <li><a class="mono" href="latest/run.webm">run.webm</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="section" id="steps">
      <div class="h3line">
        <h3>执行步骤与不符合预期项</h3>
        <a class="permalink" href="#steps">#</a>
      </div>
      <div class="card">
        <h2>步骤明细</h2>
        <p class='warn'>未生成 steps.json（脚本可能在早期退出）</p>
      </div>
      <div class="card" style="margin-top: 12px;">
        <h2>不符合预期项总览</h2>
        <p class='ok'>✅ 未发现不符合预期项</p>
        <p class="warn">复现入口：打开 <span class="mono">http://localhost:20260</span> → 导入 → 明细表搜索信用代码 → 修改/对照 → 导出后打开 Excel 对照。</p>
      </div>
      <div class="card" style="margin-top: 12px;">
        <h2>修改动作覆盖</h2>
        <p class="warn">复现：在首页输入框按信用代码搜索，修改对应字段输入框，失焦（blur）触发自动保存，然后导出检查。</p>
        <div class='table-wrap'><table><thead><tr><th>#</th><th>统一社会信用代码</th><th>字段</th><th>新值</th><th>UI(立即)</th><th>UI(刷新后)</th><th>结果</th><th>覆盖场景</th><th>错误</th></tr></thead><tbody><tr><td class='mono'>1</td><td class='mono'>91120000GQ80QA0DGC</td><td>本年-本月</td><td class='mono'>123.0</td><td class='mono'>123</td><td class='mono'>2950</td><td class='ok'>PASS</td><td>批发(1)：微调（本年-本月），覆盖保存</td><td class='mono'></td></tr><tr><td class='mono'>2</td><td class='mono'>91120000GQ80QA0DGC</td><td>上年-本月</td><td class='mono'>2634.0</td><td class='mono'>2634</td><td class='mono'>2634</td><td class='ok'>PASS</td><td>批发(1)：上年同期微调（上年-本月），覆盖 lastYearMonth editable 保存</td><td class='mono'></td></tr><tr><td class='mono'>3</td><td class='mono'>91120000GQ80QA0DGC</td><td>同比增速(当月)</td><td class='mono'>12.0</td><td class='mono'>12</td><td class='mono'>12</td><td class='ok'>PASS</td><td>批发(1)：修改增速字段（同比增速(当月)），覆盖 rate 保存</td><td class='mono'></td></tr><tr><td class='mono'>4</td><td class='mono'>91120000GQ80QA0DGC</td><td>本年-1—本月</td><td class='mono'>33743.0</td><td class='mono'>33743</td><td class='mono'>36179</td><td class='ok'>PASS</td><td>批发(1)：累计微调（本年-1—本月），覆盖 cumulative editable 保存</td><td class='mono'></td></tr><tr><td class='mono'>5</td><td class='mono'>91120000GQ80QA0DGC</td><td>累计同比增速</td><td class='mono'>6.0</td><td class='mono'>6</td><td class='mono'>6</td><td class='ok'>PASS</td><td>批发(1)：累计增速修改（累计同比增速），覆盖 cumulative rate 保存</td><td class='mono'></td></tr><tr><td class='mono'>6</td><td class='mono'>91120000K0QH3LH7PH</td><td>本年-本月</td><td class='mono'>0.0</td><td class='mono'>0</td><td class='mono'>0</td><td class='ok'>PASS</td><td>批发(2)：本年-本月置 0（本年-本月），覆盖 zero 保存</td><td class='mono'></td></tr><tr><td class='mono'>7</td><td class='mono'>914401007RDD76M0RF</td><td>零售额;本年-本月</td><td class='mono'>0.0</td><td class='mono'>0</td><td class='mono'>1787</td><td class='ok'>PASS</td><td>零售(1)：置 0（零售额;本年-本月），覆盖 zero 保存</td><td class='mono'></td></tr><tr><td class='mono'>8</td><td class='mono'>914401007RDD76M0RF</td><td>零售额;上年-本月</td><td class='mono'>1842.0</td><td class='mono'>1842</td><td class='mono'>1842</td><td class='ok'>PASS</td><td>零售(1)：上年同期微调（零售额;上年-本月），覆盖 lastYearMonth editable 保存</td><td class='mono'></td></tr><tr><td class='mono'>9</td><td class='mono'>914401007RDD76M0RF</td><td>零售额;同比增速(当月)</td><td class='mono'>-3.0</td><td class='mono'>-3</td><td class='mono'>-3</td><td class='ok'>PASS</td><td>零售(1)：负增速（零售额;同比增速(当月)），覆盖 rate/negative 保存</td><td class='mono'></td></tr><tr><td class='mono'>10</td><td class='mono'>911100000XU3103UXP</td><td>零售额;本年-本月</td><td class='mono'>999.0</td><td class='mono'>999</td><td class='mono'>999</td><td class='ok'>PASS</td><td>零售(2)：本年-本月大幅微调（零售额;本年-本月），覆盖大数保存</td><td class='mono'></td></tr><tr><td class='mono'>11</td><td class='mono'>911200002NHNAFGYMD</td><td>本年-本月</td><td class='mono'>50.0</td><td class='mono'>50</td><td class='mono'>144</td><td class='ok'>PASS</td><td>住宿(1)：营业额微调（本年-本月），覆盖住餐主指标 editable 保存</td><td class='mono'></td></tr><tr><td class='mono'>12</td><td class='mono'>911200002NHNAFGYMD</td><td>同比增速(当月)</td><td class='mono'>9.0</td><td class='mono'>9</td><td class='mono'>9</td><td class='ok'>PASS</td><td>住宿(1)：修改增速字段（同比增速(当月)），覆盖 rate editable 保存</td><td class='mono'></td></tr><tr><td class='mono'>13</td><td class='mono'>91320500TCE5UYN5HX</td><td>本年-本月</td><td class='mono'>-20.0</td><td class='mono'>-20</td><td class='mono'>-20</td><td class='ok'>PASS</td><td>住宿(2)：负数微调（本年-本月），覆盖 negative 保存</td><td class='mono'></td></tr><tr><td class='mono'>14</td><td class='mono'>9111000047L91UDRD4</td><td>本年-本月</td><td class='mono'>20.0</td><td class='mono'>20</td><td class='mono'>355</td><td class='ok'>PASS</td><td>餐饮(1)：营业额微调（本年-本月），覆盖保存</td><td class='mono'></td></tr><tr><td class='mono'>15</td><td class='mono'>9111000047L91UDRD4</td><td>同比增速(当月)</td><td class='mono'>-7.0</td><td class='mono'>-7</td><td class='mono'>-7</td><td class='ok'>PASS</td><td>餐饮(1)：负增速（同比增速(当月)），覆盖 rate/negative 保存</td><td class='mono'></td></tr><tr><td class='mono'>16</td><td class='mono'>91110000ALPM9TX5GT</td><td>本年-本月</td><td class='mono'>333.0</td><td class='mono'>333</td><td class='mono'>333</td><td class='ok'>PASS</td><td>餐饮(2)：本年-本月大幅微调（本年-本月），覆盖大数保存</td><td class='mono'></td></tr></tbody></table></div>
      </div>
      <div class="card" style="margin-top: 12px;">
        <h2>Tab 行数与总数</h2>
        <p class="warn">目的：覆盖“全部/批发/零售/住宿/餐饮”tab 切换与数据是否加载。</p>
        <div class='table-wrap'><table><thead><tr><th>Tab</th><th>结果</th><th>表格行数</th><th>底部总数文案</th><th>错误</th></tr></thead><tbody><tr><td class='mono'>全部</td><td class='ok'>PASS</td><td class='mono'>225</td><td class='mono'>共 225 家企业</td><td class='mono'></td></tr><tr><td class='mono'>批发</td><td class='ok'>PASS</td><td class='mono'>23</td><td class='mono'>共 23 家企业</td><td class='mono'></td></tr><tr><td class='mono'>零售</td><td class='ok'>PASS</td><td class='mono'>155</td><td class='mono'>共 155 家企业</td><td class='mono'></td></tr><tr><td class='mono'>住宿</td><td class='ok'>PASS</td><td class='mono'>9</td><td class='mono'>共 9 家企业</td><td class='mono'></td></tr><tr><td class='mono'>餐饮</td><td class='ok'>PASS</td><td class='mono'>38</td><td class='mono'>共 38 家企业</td><td class='mono'></td></tr></tbody></table></div>
      </div>
      <div class="card" style="margin-top: 12px;">
        <h2>Tab 覆盖与计数（Excel vs UI）</h2>
        <p class="warn">目的：对标 PRD，确保输入 Excel 有的企业在明细表中完整呈现（企业覆盖/计数一致）。</p>
        <p class='warn'>完整列表：<a class='mono' href='tab_consistency.json'>tab_consistency.json</a></p><div class='table-wrap'><table><thead><tr><th>Sheet</th><th>Excel 企业数</th><th>UI 企业数(抽取)</th><th>UI Tab 行数</th><th>UI Tab 文案</th><th>结果</th><th>原因</th><th>复现</th></tr></thead><tbody><tr><td class='mono'>批发</td><td class='mono'>23</td><td class='mono'>23</td><td class='mono'>23</td><td class='mono'>共 23 家企业</td><td class='ok'>OK</td><td></td><td>导入后切换到「批发」Tab，对比：UI 企业数 vs 输入 Excel「批发」Sheet 的企业行数</td></tr><tr><td class='mono'>零售</td><td class='mono'>155</td><td class='mono'>155</td><td class='mono'>155</td><td class='mono'>共 155 家企业</td><td class='ok'>OK</td><td></td><td>导入后切换到「零售」Tab，对比：UI 企业数 vs 输入 Excel「零售」Sheet 的企业行数</td></tr><tr><td class='mono'>住宿</td><td class='mono'>9</td><td class='mono'>9</td><td class='mono'>9</td><td class='mono'>共 9 家企业</td><td class='ok'>OK</td><td></td><td>导入后切换到「住宿」Tab，对比：UI 企业数 vs 输入 Excel「住宿」Sheet 的企业行数</td></tr><tr><td class='mono'>餐饮</td><td class='mono'>38</td><td class='mono'>38</td><td class='mono'>38</td><td class='mono'>共 38 家企业</td><td class='ok'>OK</td><td></td><td>导入后切换到「餐饮」Tab，对比：UI 企业数 vs 输入 Excel「餐饮」Sheet 的企业行数</td></tr></tbody></table></div>
      </div>
      <div class="card" style="margin-top: 12px;">
        <h2>UI 派生字段一致性检查</h2>
        <p class="warn">目的：覆盖字段联动/DAG 的最小自洽性：派生列应与基础列满足恒等关系。</p>
        <p class='ok'>✅ 未发现 UI 派生字段不一致</p>
      </div>
      <div class="card" style="margin-top: 12px;">
        <h2>UI 抽取状态</h2>
        <div class="kv">
          <div class="k">导入后抽取</div><div class="v">OK</div>
          <div class="k">导入后错误</div><div class="v"></div>
          <div class="k">修改后抽取</div><div class="v">OK</div>
          <div class="k">修改后错误</div><div class="v"></div>
          <div class="k">输入 Excel 打开</div><div class="v">OK</div>
          <div class="k">导出 Excel 打开</div><div class="v">OK</div>
          <div class="k">导出 Excel(raw) 打开</div><div class="v">OK</div>
          <div class="k">导出 raw 错误</div><div class="v"></div>
          <div class="k">定稿模板</div><div class="v">/Users/anner/code/Northstar/prd/12月月报（定）.xlsx</div>
          <div class="k">定稿模板错误</div><div class="v"></div>
        </div>
      </div>
      <div class="card" style="margin-top: 12px;">
        <h2>输入 Excel 结构对标 PRD</h2>
        <p class='ok'>✅ 输入 sheet 集合符合 PRD（允许 extra）</p><p class='warn'>完整列表：<a class='mono' href='input_structure.json'>input_structure.json</a></p>
      </div>
    </div>

    <div class="section" id="completeness">
      <div class="h3line">
        <h3>明细表数据完整性案例（输入 Excel → 明细表）</h3>
        <a class="permalink" href="#completeness">#</a>
      </div>
      <div class="card">
        <h2>字段级完整性（大量案例）</h2>
        <p class="warn">完整列表：<a class="mono" href="completeness_cases.json">completeness_cases.json</a> / <a class="mono" href="completeness_summary.json">completeness_summary.json</a></p>
        <p class='ok'>✅ 关键案例（用户指定）</p><div class='table-wrap'><table><thead><tr><th>Sheet</th><th>统一社会信用代码</th><th>企业</th><th>字段</th><th>Excel</th><th>明细表</th><th>结果</th><th>原因</th><th>如何复现</th></tr></thead><tbody><tr><td class='mono'>零售</td><td class='mono'>914401007RDD76M0RF</td><td>华南烟酒测试企业0355有限责任公司</td><td>上年-本月</td><td class='mono'>1841</td><td class='mono'>1841</td><td class='ok'>PASS</td><td></td><td>首页明细表搜索 914401007RDD76M0RF → 展示列 上年-本月 → 对照输入 Excel Sheet「零售」的对应列</td></tr></tbody></table></div><div style='height:12px'></div><p class='ok'>企业覆盖缺失：0</p><div style='height:12px'></div><p class='ok'>✅ 字段级完整性断言：未发现失败</p>
      </div>
      <div class="card" style="margin-top: 12px;">
        <h2>缺失企业（Excel 有，但明细表缺）</h2>
        <p class="warn">完整列表：<a class="mono" href="missing_codes_by_sheet.json">missing_codes_by_sheet.json</a></p>
        <div class='card' style='margin-top:12px;'><h2>Sheet「批发」缺失企业：0</h2><p class='ok'>✅ 无缺失</p></div><div class='card' style='margin-top:12px;'><h2>Sheet「零售」缺失企业：0</h2><p class='ok'>✅ 无缺失</p></div><div class='card' style='margin-top:12px;'><h2>Sheet「住宿」缺失企业：0</h2><p class='ok'>✅ 无缺失</p></div><div class='card' style='margin-top:12px;'><h2>Sheet「餐饮」缺失企业：0</h2><p class='ok'>✅ 无缺失</p></div>
      </div>
      <div class="card" style="margin-top: 12px;">
        <h2>衍生 Sheet 列覆盖（有值列 → UI 列是否存在）</h2>
        <p class="warn">完整列表：<a class="mono" href="derived_column_coverage.json">derived_column_coverage.json</a></p>
        <div class='table-wrap'><table><thead><tr><th>Sheet</th><th>Excel 列</th><th>有值数量</th><th>映射到明细表列</th><th>状态</th><th>示例</th><th>建议 UI 列名</th></tr></thead><tbody><tr><td class='mono'>批发</td><td class='mono'>2025年11月销售额</td><td class='mono'>24</td><td class='mono'>本年-上月</td><td class='ok'>OK</td><td class='mono'>[462, 9021, 2748]</td><td class='mono'>2025年11月销售额</td></tr><tr><td class='mono'>批发</td><td class='mono'>2025年12月销售额</td><td class='mono'>1</td><td class='mono'>本年-本月</td><td class='ok'>OK</td><td class='mono'>[0]</td><td class='mono'>2025年12月销售额</td></tr><tr><td class='mono'>批发</td><td class='mono'>2024年;12月;商品销售额;千元</td><td class='mono'>18</td><td class='mono'>上年-本月</td><td class='ok'>OK</td><td class='mono'>[848, 17086, 3095]</td><td class='mono'>2024年;12月;商品销售额;千元</td></tr><tr><td class='mono'>批发</td><td class='mono'>12月销售额增速</td><td class='mono'>24</td><td class='mono'>同比增速(当月)</td><td class='ok'>OK</td><td class='mono'>[-100, 0]</td><td class='mono'>12月销售额增速</td></tr><tr><td class='mono'>批发</td><td class='mono'>2025年1-12月销售额</td><td class='mono'>24</td><td class='mono'>本年-1—本月</td><td class='ok'>OK</td><td class='mono'>[11289, 115542, 40271]</td><td class='mono'>2025年1-12月销售额</td></tr><tr><td class='mono'>批发</td><td class='mono'>2024年;1-12月;商品销售额;千元</td><td class='mono'>24</td><td class='mono'>上年-1—本月</td><td class='ok'>OK</td><td class='mono'>[13698, 126007, 37462]</td><td class='mono'>2024年;1-12月;商品销售额;千元</td></tr><tr><td class='mono'>批发</td><td class='mono'>1-12月增速</td><td class='mono'>24</td><td class='mono'>累计同比增速</td><td class='ok'>OK</td><td class='mono'>[-17.5865089794131, -8.30509416143548, 7.49826490844055]</td><td class='mono'>1-12月增速</td></tr><tr><td class='mono'>批发</td><td class='mono'>2025年11月零售额</td><td class='mono'>24</td><td class='mono'>零售额;本年-上月</td><td class='ok'>OK</td><td class='mono'>[0, 3501, 1219]</td><td class='mono'>2025年11月零售额</td></tr><tr><td class='mono'>批发</td><td class='mono'>2025年12月零售额</td><td class='mono'>1</td><td class='mono'>零售额;本年-本月</td><td class='ok'>OK</td><td class='mono'>[0]</td><td class='mono'>2025年12月零售额</td></tr><tr><td class='mono'>批发</td><td class='mono'>2024年;12月;商品零售额;千元</td><td class='mono'>17</td><td class='mono'>零售额;上年-本月</td><td class='ok'>OK</td><td class='mono'>[251, 6647, 0]</td><td class='mono'>2024年;12月;商品零售额;千元</td></tr><tr><td class='mono'>批发</td><td class='mono'>12月零售额增速</td><td class='mono'>24</td><td class='mono'>零售额;同比增速(当月)</td><td class='ok'>OK</td><td class='mono'>[-100, 0]</td><td class='mono'>12月零售额增速</td></tr><tr><td class='mono'>批发</td><td class='mono'>2025年1-12月零售额</td><td class='mono'>24</td><td class='mono'>零售额;本年-1—本月</td><td class='ok'>OK</td><td class='mono'>[3066, 40335, 0]</td><td class='mono'>2025年1-12月零售额</td></tr><tr><td class='mono'>批发</td><td class='mono'>2024年;1-12月;商品零售额;千元</td><td class='mono'>24</td><td class='mono'>零售额;上年-1—本月</td><td class='ok'>OK</td><td class='mono'>[4403, 45074, 0]</td><td class='mono'>2024年;1-12月;商品零售额;千元</td></tr><tr><td class='mono'>批发</td><td class='mono'>1-12月增速#2</td><td class='mono'>24</td><td class='mono'>零售额;累计同比增速</td><td class='ok'>OK</td><td class='mono'>[-30.3656597774245, -10.5138217154013, 0]</td><td class='mono'>1-12月增速</td></tr><tr><td class='mono'>批发</td><td class='mono'>零售额占比</td><td class='mono'>24</td><td class='mono'>零销比(%)</td><td class='ok'>OK</td><td class='mono'>[0]</td><td class='mono'>零售额占比</td></tr><tr><td class='mono'>零售</td><td class='mono'>2025年11月销售额</td><td class='mono'>156</td><td class='mono'>本年-上月</td><td class='ok'>OK</td><td class='mono'>[2317, 4926, 1282]</td><td class='mono'>2025年11月销售额</td></tr><tr><td class='mono'>零售</td><td class='mono'>2025年12月销售额</td><td class='mono'>1</td><td class='mono'>本年-本月</td><td class='ok'>OK</td><td class='mono'>[0]</td><td class='mono'>2025年12月销售额</td></tr><tr><td class='mono'>零售</td><td class='mono'>2024年;12月;商品销售额;千元</td><td class='mono'>131</td><td class='mono'>上年-本月</td><td class='ok'>OK</td><td class='mono'>[1841, 4997, 993]</td><td class='mono'>2024年;12月;商品销售额;千元</td></tr><tr><td class='mono'>零售</td><td class='mono'>12月销售额增速</td><td class='mono'>156</td><td class='mono'>同比增速(当月)</td><td class='ok'>OK</td><td class='mono'>[-100, 0]</td><td class='mono'>12月销售额增速</td></tr><tr><td class='mono'>零售</td><td class='mono'>2025年1-12月销售额</td><td class='mono'>156</td><td class='mono'>本年-1—本月</td><td class='ok'>OK</td><td class='mono'>[19613, 44278, 8513]</td><td class='mono'>2025年1-12月销售额</td></tr><tr><td class='mono'>零售</td><td class='mono'>2024年;1-12月;商品销售额;千元</td><td class='mono'>156</td><td class='mono'>上年-1—本月</td><td class='ok'>OK</td><td class='mono'>[17532, 43436, 8195]</td><td class='mono'>2024年;1-12月;商品销售额;千元</td></tr><tr><td class='mono'>零售</td><td class='mono'>1-12月增速</td><td class='mono'>156</td><td class='mono'>累计同比增速</td><td class='ok'>OK</td><td class='mono'>[11.869723933379, 1.93848420664886, 3.8804148871263]</td><td class='mono'>1-12月增速</td></tr><tr><td class='mono'>零售</td><td class='mono'>2025年11月零售额</td><td class='mono'>156</td><td class='mono'>零售额;本年-上月</td><td class='ok'>OK</td><td class='mono'>[2317, 4926, 1282]</td><td class='mono'>2025年11月零售额</td></tr><tr><td class='mono'>零售</td><td class='mono'>2025年12月零售额</td><td class='mono'>155</td><td class='mono'>零售额;本年-本月</td><td class='ok'>OK</td><td class='mono'>[0]</td><td class='mono'>2025年12月零售额</td></tr><tr><td class='mono'>零售</td><td class='mono'>2024年;12月;商品零售额;千元</td><td class='mono'>155</td><td class='mono'>零售额;上年-本月</td><td class='ok'>OK</td><td class='mono'>[1841, 4997, 993]</td><td class='mono'>2024年;12月;商品零售额;千元</td></tr><tr><td class='mono'>零售</td><td class='mono'>12月零售额增速</td><td class='mono'>156</td><td class='mono'>零售额;同比增速(当月)</td><td class='ok'>OK</td><td class='mono'>[-100, 0]</td><td class='mono'>12月零售额增速</td></tr><tr><td class='mono'>零售</td><td class='mono'>2025年1-12月零售额</td><td class='mono'>155</td><td class='mono'>零售额;本年-1—本月</td><td class='ok'>OK</td><td class='mono'>[19613, 44278, 8513]</td><td class='mono'>2025年1-12月零售额</td></tr><tr><td class='mono'>零售</td><td class='mono'>2024年;1-12月;商品零售额;千元</td><td class='mono'>156</td><td class='mono'>零售额;上年-1—本月</td><td class='ok'>OK</td><td class='mono'>[17532, 43436, 8195]</td><td class='mono'>2024年;1-12月;商品零售额;千元</td></tr><tr><td class='mono'>零售</td><td class='mono'>1-12月增速#2</td><td class='mono'>156</td><td class='mono'>零售额;累计同比增速</td><td class='ok'>OK</td><td class='mono'>[11.869723933379, 1.93848420664886, 3.8804148871263]</td><td class='mono'>1-12月增速</td></tr><tr><td class='mono'>零售</td><td class='mono'>零售额占比</td><td class='mono'>154</td><td class='mono'>零销比(%)</td><td class='ok'>OK</td><td class='mono'>[3, 4, 2]</td><td class='mono'>零售额占比</td></tr><tr><td class='mono'>住宿</td><td class='mono'>2025年11月营业额</td><td class='mono'>10</td><td class='mono'>本年-上月</td><td class='ok'>OK</td><td class='mono'>[382, 408, 812]</td><td class='mono'>2025年11月营业额</td></tr><tr><td class='mono'>住宿</td><td class='mono'>2025年12月营业额</td><td class='mono'>1</td><td class='mono'>本年-本月</td><td class='ok'>OK</td><td class='mono'>[0]</td><td class='mono'>2025年12月营业额</td></tr><tr><td class='mono'>住宿</td><td class='mono'>2024年12月;营业额总计;千元</td><td class='mono'>9</td><td class='mono'>上年-本月</td><td class='ok'>OK</td><td class='mono'>[311, 327, 785]</td><td class='mono'>2024年12月;营业额总计;千元</td></tr><tr><td class='mono'>住宿</td><td class='mono'>12月增速</td><td class='mono'>10</td><td class='mono'>同比增速(当月)</td><td class='ok'>OK</td><td class='mono'>[-100, 0]</td><td class='mono'>12月增速</td></tr><tr><td class='mono'>住宿</td><td class='mono'>2025年1-12月营业额</td><td class='mono'>10</td><td class='mono'>本年-1—本月</td><td class='ok'>OK</td><td class='mono'>[3971, 4164, 8284]</td><td class='mono'>2025年1-12月营业额</td></tr><tr><td class='mono'>住宿</td><td class='mono'>2024年1-12月;营业额总计;千元</td><td class='mono'>10</td><td class='mono'>上年-1—本月</td><td class='ok'>OK</td><td class='mono'>[3460, 3620, 7682]</td><td class='mono'>2024年1-12月;营业额总计;千元</td></tr><tr><td class='mono'>住宿</td><td class='mono'>1-12月增速</td><td class='mono'>10</td><td class='mono'>累计同比增速</td><td class='ok'>OK</td><td class='mono'>[14.7687861271676, 15.0276243093923, 7.83650091122104]</td><td class='mono'>1-12月增速</td></tr><tr><td class='mono'>住宿</td><td class='mono'>2025年12月零售额</td><td class='mono'>10</td><td class='mono'>零售额;本年-本月</td><td class='ok'>OK</td><td class='mono'>[0]</td><td class='mono'>2025年12月零售额</td></tr><tr><td class='mono'>住宿</td><td class='mono'>2024年12月零售额</td><td class='mono'>10</td><td class='mono'>零售额;上年-本月</td><td class='ok'>OK</td><td class='mono'>[0, 127, 386]</td><td class='mono'>2024年12月零售额</td></tr><tr><td class='mono'>餐饮</td><td class='mono'>2025年11月营业额</td><td class='mono'>39</td><td class='mono'>本年-上月</td><td class='ok'>OK</td><td class='mono'>[1131, 1184, 0]</td><td class='mono'>2025年11月营业额</td></tr><tr><td class='mono'>餐饮</td><td class='mono'>2025年12月营业额</td><td class='mono'>1</td><td class='mono'>本年-本月</td><td class='ok'>OK</td><td class='mono'>[0]</td><td class='mono'>2025年12月营业额</td></tr><tr><td class='mono'>餐饮</td><td class='mono'>2024年12月;营业额总计;千元</td><td class='mono'>37</td><td class='mono'>上年-本月</td><td class='ok'>OK</td><td class='mono'>[1487, 1391, 282]</td><td class='mono'>2024年12月;营业额总计;千元</td></tr><tr><td class='mono'>餐饮</td><td class='mono'>12月增速</td><td class='mono'>39</td><td class='mono'>同比增速(当月)</td><td class='ok'>OK</td><td class='mono'>[-100, 0]</td><td class='mono'>12月增速</td></tr><tr><td class='mono'>餐饮</td><td class='mono'>2025年1-12月营业额</td><td class='mono'>39</td><td class='mono'>本年-1—本月</td><td class='ok'>OK</td><td class='mono'>[18135, 15670, 1641]</td><td class='mono'>2025年1-12月营业额</td></tr><tr><td class='mono'>餐饮</td><td class='mono'>2024年1-12月;营业额总计;千元</td><td class='mono'>39</td><td class='mono'>上年-1—本月</td><td class='ok'>OK</td><td class='mono'>[17932, 15098, 3211]</td><td class='mono'>2024年1-12月;营业额总计;千元</td></tr><tr><td class='mono'>餐饮</td><td class='mono'>1-12月增速</td><td class='mono'>39</td><td class='mono'>累计同比增速</td><td class='ok'>OK</td><td class='mono'>[1.1320544278385, 3.78858126904226, -48.894425412644]</td><td class='mono'>1-12月增速</td></tr><tr><td class='mono'>餐饮</td><td class='mono'>2025年12月零售额</td><td class='mono'>39</td><td class='mono'>零售额;本年-本月</td><td class='ok'>OK</td><td class='mono'>[0]</td><td class='mono'>2025年12月零售额</td></tr><tr><td class='mono'>餐饮</td><td class='mono'>2024年12月零售额</td><td class='mono'>39</td><td class='mono'>零售额;上年-本月</td><td class='ok'>OK</td><td class='mono'>[1446, 1364, 282]</td><td class='mono'>2024年12月零售额</td></tr></tbody></table></div>
      </div>
    </div>

    <div class="section" id="suggestions">
      <div class="h3line">
        <h3>改动建议（仅写在报告内）</h3>
        <a class="permalink" href="#suggestions">#</a>
      </div>
      <div class="card">
        <h2>建议汇总</h2>
        <p class='ok'>✅ 暂无额外改动建议</p>
      </div>
    </div>

    <div class="section" id="import">
      <div class="h3line">
        <h3>导入一致性（明细表 vs 输入 Excel）</h3>
        <a class="permalink" href="#import">#</a>
      </div>
      <div class="card">
        <h2>覆盖检查</h2>
        <p class='ok'>✅ 覆盖完整</p>
        <p class="warn">复现：打开输入 Excel 的对应 Sheet（来源表），在“统一社会信用代码”列定位企业，对比明细表同字段显示。</p>
      </div>
      <div class="card" style="margin-top: 12px;">
        <h2>字段一致性</h2>
        <p class='ok'>✅ 未发现差异</p>
        <p class="warn">复现：首页明细表搜索信用代码，打开“列”展示相关字段，对照输入 Excel 的同字段值。</p>
      </div>
    </div>

	    <div class="section" id="export">
        <div class="h3line">
	        <h3>导出一致性（导出 Excel vs 明细表[修改后]）</h3>
          <a class="permalink" href="#export">#</a>
        </div>
      <div class="card">
        <h2>覆盖检查</h2>
        <p class='ok'>✅ 覆盖完整</p>
        <p class="warn">复现：点击“导出”下载 xlsx，打开后在对应 Sheet 用“统一社会信用代码”定位行，对照明细表修改后的值。</p>
      </div>
      <div class="card" style="margin-top: 12px;">
        <h2>字段一致性</h2>
        <p class='ok'>✅ 未发现差异</p>
        <p class="warn">复现：先确认修改动作已保存（输入框失焦），再导出并对照字段。</p>
      </div>
      <div class="card" style="margin-top: 12px;">
        <h2>修改动作 → 导出回归校验</h2>
        <p class="warn">完整列表：<a class="mono" href="action_export_checks.json">action_export_checks.json</a></p>
        <p class='ok'>✅ 全部 PASS</p><div class='table-wrap'><table><thead><tr><th>统一社会信用代码</th><th>字段</th><th>Sheet</th><th>导出列</th><th>期望</th><th>实际</th><th>结果</th><th>原因</th></tr></thead><tbody><tr><td class='mono'>91120000GQ80QA0DGC</td><td>本年-本月</td><td class='mono'>批发</td><td class='mono'>商品销售额;本年-本月</td><td class='mono'>2950.0</td><td class='mono'>2950</td><td class='ok'>PASS</td><td>UI 刷新后值与期望修改不一致（可能未保存），导出按刷新后值校验</td></tr><tr><td class='mono'>91120000GQ80QA0DGC</td><td>上年-本月</td><td class='mono'>批发</td><td class='mono'>商品销售额;上年-本月</td><td class='mono'>2634.0</td><td class='mono'>2634</td><td class='ok'>PASS</td><td></td></tr><tr><td class='mono'>91120000GQ80QA0DGC</td><td>同比增速(当月)</td><td class='mono'>批发</td><td class='mono'>(衍生指标)销售额当月增速</td><td class='mono'>12.0</td><td class='mono'>12</td><td class='ok'>PASS</td><td></td></tr><tr><td class='mono'>91120000GQ80QA0DGC</td><td>本年-1—本月</td><td class='mono'>批发</td><td class='mono'>商品销售额;本年-1—本月</td><td class='mono'>36179.0</td><td class='mono'>36179</td><td class='ok'>PASS</td><td>UI 刷新后值与期望修改不一致（可能未保存），导出按刷新后值校验</td></tr><tr><td class='mono'>91120000GQ80QA0DGC</td><td>累计同比增速</td><td class='mono'>批发</td><td class='mono'>(衍生指标)销售额累计增速</td><td class='mono'>6.0</td><td class='mono'>6</td><td class='ok'>PASS</td><td></td></tr><tr><td class='mono'>91120000K0QH3LH7PH</td><td>本年-本月</td><td class='mono'>批发</td><td class='mono'>商品销售额;本年-本月</td><td class='mono'></td><td class='mono'></td><td class='ok'>PASS</td><td></td></tr><tr><td class='mono'>914401007RDD76M0RF</td><td>零售额;本年-本月</td><td class='mono'>零售</td><td class='mono'>零售额;本年-本月</td><td class='mono'>1787.0</td><td class='mono'>1787</td><td class='ok'>PASS</td><td>UI 刷新后值与期望修改不一致（可能未保存），导出按刷新后值校验</td></tr><tr><td class='mono'>914401007RDD76M0RF</td><td>零售额;上年-本月</td><td class='mono'>零售</td><td class='mono'>零售额;上年-本月</td><td class='mono'>1842.0</td><td class='mono'>1842</td><td class='ok'>PASS</td><td></td></tr><tr><td class='mono'>914401007RDD76M0RF</td><td>零售额;同比增速(当月)</td><td class='mono'>零售</td><td class='mono'>(衍生指标)零售额当月增速</td><td class='mono'>-3.0</td><td class='mono'>-3</td><td class='ok'>PASS</td><td></td></tr><tr><td class='mono'>911100000XU3103UXP</td><td>零售额;本年-本月</td><td class='mono'>零售</td><td class='mono'>零售额;本年-本月</td><td class='mono'>999.0</td><td class='mono'>999</td><td class='ok'>PASS</td><td></td></tr><tr><td class='mono'>911200002NHNAFGYMD</td><td>本年-本月</td><td class='mono'>住宿</td><td class='mono'>营业额;本年-本月</td><td class='mono'>144.0</td><td class='mono'>144</td><td class='ok'>PASS</td><td>UI 刷新后值与期望修改不一致（可能未保存），导出按刷新后值校验</td></tr><tr><td class='mono'>911200002NHNAFGYMD</td><td>同比增速(当月)</td><td class='mono'>住宿</td><td class='mono'>(衍生指标)营业额当月增速</td><td class='mono'>9.0</td><td class='mono'>9</td><td class='ok'>PASS</td><td></td></tr><tr><td class='mono'>91320500TCE5UYN5HX</td><td>本年-本月</td><td class='mono'>住宿</td><td class='mono'>营业额;本年-本月</td><td class='mono'>-20.0</td><td class='mono'>-20</td><td class='ok'>PASS</td><td></td></tr><tr><td class='mono'>9111000047L91UDRD4</td><td>本年-本月</td><td class='mono'>餐饮</td><td class='mono'>营业额;本年-本月</td><td class='mono'>355.0</td><td class='mono'>355</td><td class='ok'>PASS</td><td>UI 刷新后值与期望修改不一致（可能未保存），导出按刷新后值校验</td></tr><tr><td class='mono'>9111000047L91UDRD4</td><td>同比增速(当月)</td><td class='mono'>餐饮</td><td class='mono'>(衍生指标)营业额当月增速</td><td class='mono'>-7.0</td><td class='mono'>-7</td><td class='ok'>PASS</td><td></td></tr><tr><td class='mono'>91110000ALPM9TX5GT</td><td>本年-本月</td><td class='mono'>餐饮</td><td class='mono'>营业额;本年-本月</td><td class='mono'>333.0</td><td class='mono'>333</td><td class='ok'>PASS</td><td></td></tr></tbody></table></div>
	      </div>
	    </div>

	    <div class="section" id="template">
        <div class="h3line">
	        <h3>导出模板结构对标 PRD</h3>
          <a class="permalink" href="#template">#</a>
        </div>
	      <div class="card">
	        <h2>Sheet/表头结构</h2>
	        <p class='warn'>定稿模板：/Users/anner/code/Northstar/prd/12月月报（定）.xlsx</p><p class='warn'>完整列表：<a class='mono' href='export_template_checks.json'>export_template_checks.json</a></p><div class='table-wrap'><table><thead><tr><th>Sheet</th><th>模板表头列数</th><th>导出表头列数</th><th>结果</th><th>原因</th><th>复现</th></tr></thead><tbody><tr><td class='mono'>批零总表</td><td class='mono'>17</td><td class='mono'>17</td><td class='ok'>OK</td><td></td><td>打开 prd/12月月报（定）.xlsx 与导出 Excel 的 Sheet「批零总表」，对比表头（含空白列）是否逐列一致</td></tr><tr><td class='mono'>住餐总表</td><td class='mono'>21</td><td class='mono'>21</td><td class='ok'>OK</td><td></td><td>打开 prd/12月月报（定）.xlsx 与导出 Excel 的 Sheet「住餐总表」，对比表头（含空白列）是否逐列一致</td></tr><tr><td class='mono'>批发</td><td class='mono'>17</td><td class='mono'>17</td><td class='ok'>OK</td><td></td><td>打开 prd/12月月报（定）.xlsx 与导出 Excel 的 Sheet「批发」，对比表头（含空白列）是否逐列一致</td></tr><tr><td class='mono'>零售</td><td class='mono'>17</td><td class='mono'>17</td><td class='ok'>OK</td><td></td><td>打开 prd/12月月报（定）.xlsx 与导出 Excel 的 Sheet「零售」，对比表头（含空白列）是否逐列一致</td></tr><tr><td class='mono'>住宿</td><td class='mono'>21</td><td class='mono'>21</td><td class='ok'>OK</td><td></td><td>打开 prd/12月月报（定）.xlsx 与导出 Excel 的 Sheet「住宿」，对比表头（含空白列）是否逐列一致</td></tr><tr><td class='mono'>餐饮</td><td class='mono'>21</td><td class='mono'>21</td><td class='ok'>OK</td><td></td><td>打开 prd/12月月报（定）.xlsx 与导出 Excel 的 Sheet「餐饮」，对比表头（含空白列）是否逐列一致</td></tr><tr><td class='mono'>吃穿用</td><td class='mono'>26</td><td class='mono'>26</td><td class='ok'>OK</td><td></td><td>打开 prd/12月月报（定）.xlsx 与导出 Excel 的 Sheet「吃穿用」，对比表头（含空白列）是否逐列一致</td></tr><tr><td class='mono'>小微</td><td class='mono'>6</td><td class='mono'>6</td><td class='ok'>OK</td><td></td><td>打开 prd/12月月报（定）.xlsx 与导出 Excel 的 Sheet「小微」，对比表头（含空白列）是否逐列一致</td></tr><tr><td class='mono'>吃穿用（剔除）</td><td class='mono'>5</td><td class='mono'>5</td><td class='ok'>OK</td><td></td><td>打开 prd/12月月报（定）.xlsx 与导出 Excel 的 Sheet「吃穿用（剔除）」，对比表头（含空白列）是否逐列一致</td></tr></tbody></table></div>
	      </div>
	      <div class="card" style="margin-top: 12px;">
	        <h2>模板公式（社零额/汇总表）</h2>
	        <p class='warn'>完整列表：<a class='mono' href='export_formula_checks.json'>export_formula_checks.json</a></p><div class='table-wrap'><table><thead><tr><th>Sheet</th><th>Cell</th><th>结果</th><th>模板公式</th><th>导出公式</th><th>原因</th><th>复现</th></tr></thead><tbody><tr><td class='mono'>社零额（定）</td><td class='mono'>K3</td><td class='ok'>OK</td><td class='mono'>=E18-E21</td><td class='mono'>=E18-E21</td><td></td><td>打开导出 Excel → Sheet「社零额（定）」→ 单元格 K3，检查是否为公式且与定稿模板一致</td></tr><tr><td class='mono'>社零额（定）</td><td class='mono'>K7</td><td class='ok'>OK</td><td class='mono'>=K3-K4</td><td class='mono'>=K3-K4</td><td></td><td>打开导出 Excel → Sheet「社零额（定）」→ 单元格 K7，检查是否为公式且与定稿模板一致</td></tr><tr><td class='mono'>社零额（定）</td><td class='mono'>K9</td><td class='ok'>OK</td><td class='mono'>=(K7-K8)/K8*100</td><td class='mono'>=(K7-K8)/K8*100</td><td></td><td>打开导出 Excel → Sheet「社零额（定）」→ 单元格 K9，检查是否为公式且与定稿模板一致</td></tr><tr><td class='mono'>社零额（定）</td><td class='mono'>K15</td><td class='ok'>OK</td><td class='mono'>=K14*(1+K11/100)</td><td class='mono'>=K14*(1+K11/100)</td><td></td><td>打开导出 Excel → Sheet「社零额（定）」→ 单元格 K15，检查是否为公式且与定稿模板一致</td></tr><tr><td class='mono'>社零额（定）</td><td class='mono'>K17</td><td class='ok'>OK</td><td class='mono'>=K15+K16</td><td class='mono'>=K15+K16</td><td></td><td>打开导出 Excel → Sheet「社零额（定）」→ 单元格 K17，检查是否为公式且与定稿模板一致</td></tr><tr><td class='mono'>社零额（定）</td><td class='mono'>K19</td><td class='ok'>OK</td><td class='mono'>=(K17-K18)/K18*100</td><td class='mono'>=(K17-K18)/K18*100</td><td></td><td>打开导出 Excel → Sheet「社零额（定）」→ 单元格 K19，检查是否为公式且与定稿模板一致</td></tr><tr><td class='mono'>社零额（定）</td><td class='mono'>K23</td><td class='ok'>OK</td><td class='mono'>=(K21-K22)/K22*100</td><td class='mono'>=(K21-K22)/K22*100</td><td></td><td>打开导出 Excel → Sheet「社零额（定）」→ 单元格 K23，检查是否为公式且与定稿模板一致</td></tr><tr><td class='mono'>汇总表（定）</td><td class='mono'>D4</td><td class='ok'>OK</td><td class='mono'>=C4/B4*100</td><td class='mono'>=C4/B4*100</td><td></td><td>打开导出 Excel → Sheet「汇总表（定）」→ 单元格 D4，检查是否为公式且与定稿模板一致</td></tr><tr><td class='mono'>汇总表（定）</td><td class='mono'>F4</td><td class='ok'>OK</td><td class='mono'>=E4/C4*100</td><td class='mono'>=E4/C4*100</td><td></td><td>打开导出 Excel → Sheet「汇总表（定）」→ 单元格 F4，检查是否为公式且与定稿模板一致</td></tr><tr><td class='mono'>汇总表（定）</td><td class='mono'>D10</td><td class='ok'>OK</td><td class='mono'>=IF(D4&lt;&gt;100,&quot;已上报&quot;&amp;C4&amp;&quot;家，上报进度&quot;&amp;ROUND(D4,1)&amp;&quot;%&quot;,&quot;已全部上报&quot;)</td><td class='mono'>=IF(D4&lt;&gt;100,&quot;已上报&quot;&amp;C4&amp;&quot;家，上报进度&quot;&amp;ROUND(D4,1)&amp;&quot;%&quot;,&quot;已全部上报&quot;)</td><td></td><td>打开导出 Excel → Sheet「汇总表（定）」→ 单元格 D10，检查是否为公式且与定稿模板一致</td></tr><tr><td class='mono'>汇总表（定）</td><td class='mono'>A11</td><td class='ok'>OK</td><td class='mono'>=_xlfn.CONCAT(&quot;社会消费品零售总额：全县&quot;,B4,&quot;家限上商贸单位&quot;,D10,&quot;。&quot;,MID(A1,8,1),&quot;月，批发、零售、住宿、餐饮业销售额(营业额)同比分别增长&quot;,ROUND(K4,1),&quot;%、&quot;,ROUND(M4,1),&quot;%、&quot;,ROUND(O4,1),&quot;%、&quot;,ROUND(Q4,1),&quot;%。当月上报零售额&quot;,ROUND(G4/10000,2),&quot;亿元，同比增长&quot;,ROUND(S4,1),&quot;%；累计上报零售额&quot;,ROUND(I4/10000,2),&quot;亿元，同比增长&quot;,ROUND(T4,1),&quot;%。&quot;,MID(A1,6,4),&quot;，全社会消费品零售总额预计完成&quot;,N10,&quot;亿元，同比增长&quot;,S10,&quot;%。&quot;)</td><td class='mono'>=_xlfn.CONCAT(&quot;社会消费品零售总额：全县&quot;,B4,&quot;家限上商贸单位&quot;,D10,&quot;。&quot;,MID(A1,8,1),&quot;月，批发、零售、住宿、餐饮业销售额(营业额)同比分别增长&quot;,ROUND(K4,1),&quot;%、&quot;,ROUND(M4,1),&quot;%、&quot;,ROUND(O4,1),&quot;%、&quot;,ROUND(Q4,1),&quot;%。当月上报零售额&quot;,ROUND(G4/10000,2),&quot;亿元，同比增长&quot;,ROUND(S4,1),&quot;%；累计上报零售额&quot;,ROUND(I4/10000,2),&quot;亿元，同比增长&quot;,ROUND(T4,1),&quot;%。&quot;,MID(A1,6,4),&quot;，全社会消费品零售总额预计完成&quot;,N10,&quot;亿元，同比增长&quot;,S10,&quot;%。&quot;)</td><td></td><td>打开导出 Excel → Sheet「汇总表（定）」→ 单元格 A11，检查是否为公式且与定稿模板一致</td></tr></tbody></table></div>
	      </div>
	    </div>

	    <div class="section" id="import-log">
        <div class="h3line">
	      <h3>导入日志（UI）</h3>
          <a class="permalink" href="#import-log">#</a>
        </div>
      <div class="card">
        <h2>进度事件</h2>
        <p class="mono">count=55</p>
        <pre>开始导入 Excel 文件
发现 15 个 Sheet
正在解析 Sheet: 2024年12月批零
Sheet &quot;2024年12月批零&quot; 识别为: wr_snapshot (置信度: 1.00)
Sheet &quot;2024年12月批零&quot; 导入成功: 153 行
正在解析 Sheet: 2025年11月批零
Sheet &quot;2025年11月批零&quot; 识别为: wr_snapshot (置信度: 1.00)
Sheet &quot;2025年11月批零&quot; 导入成功: 178 行
正在解析 Sheet: 2024年3月
Sheet &quot;2024年3月&quot; 识别为: wr_snapshot (置信度: 0.95)
Sheet &quot;2024年3月&quot; 导入成功: 153 行
正在解析 Sheet: 2025年2月
Sheet &quot;2025年2月&quot; 识别为: wr_snapshot (置信度: 0.95)
Sheet &quot;2025年2月&quot; 导入成功: 176 行
正在解析 Sheet: 批发
Sheet &quot;批发&quot; 识别为: wholesale (置信度: 1.00)
识别数据月份: 2025年12月
Sheet &quot;批发&quot; 导入成功: 23 行
正在解析 Sheet: 零售
Sheet &quot;零售&quot; 识别为: retail (置信度: 1.00)
Sheet &quot;零售&quot; 导入成功: 155 行
正在解析 Sheet: 2024年12月住餐
Sheet &quot;2024年12月住餐&quot; 识别为: ac_snapshot (置信度: 1.00)
Sheet &quot;2024年12月住餐&quot; 导入成功: 45 行
正在解析 Sheet: 2025年11月住餐
Sheet &quot;2025年11月住餐&quot; 识别为: ac_snapshot (置信度: 1.00)
Sheet &quot;2025年11月住餐&quot; 导入成功: 47 行
正在解析 Sheet: 2024年3月住
Sheet &quot;2024年3月住&quot; 识别为: ac_snapshot (置信度: 0.95)
Sheet &quot;2024年3月住&quot; 导入成功: 45 行
正在解析 Sheet: 2025年2月住
Sheet &quot;2025年2月住&quot; 识别为: ac_snapshot (置信度: 0.95)
Sheet &quot;2025年2月住&quot; 导入成功: 47 行
正在解析 Sheet: 餐饮
Sheet &quot;餐饮&quot; 识别为: catering (置信度: 1.00)
Sheet &quot;餐饮&quot; 导入成功: 38 行
正在解析 Sheet: 住宿
Sheet &quot;住宿&quot; 识别为: accommodation (置信度: 1.00)
Sheet &quot;住宿&quot; 导入成功: 9 行
正在解析 Sheet: 限上零售额
Sheet &quot;限上零售额&quot; 识别为: summary (置信度: 0.80)
Sheet &quot;限上零售额&quot; 已跳过
跳过汇总表: 限上零售额
正在解析 Sheet: 小微
Sheet &quot;小微&quot; 识别为: summary (置信度: 0.80)
Sheet &quot;小微&quot; 已跳过
跳过汇总表: 小微
正在解析 Sheet: 吃穿用
Sheet &quot;吃穿用&quot; 识别为: summary (置信度: 0.80)
Sheet &quot;吃穿用&quot; 已跳过
跳过汇总表: 吃穿用
正在计算衍生字段...
衍生字段计算完成
当前操作月份已更新为: 2025年12月
导入完成</pre>
      </div>
    </div>

    <div class="section" id="browser-log">
      <div class="h3line">
        <h3>浏览器日志</h3>
        <a class="permalink" href="#browser-log">#</a>
      </div>
      <div class="grid">
        <div class="card">
          <h2>Console</h2>
          <pre>[33m[warning][0m Select is changing from uncontrolled to controlled. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.
[33m[warning][0m Select is changing from uncontrolled to controlled. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.
[33m[warning][0m Select is changing from uncontrolled to controlled. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.
[33m[warning][0m Select is changing from uncontrolled to controlled. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.
</pre>
        </div>
        <div class="card">
          <h2>Errors</h2>
          <pre></pre>
        </div>
      </div>
    </div>

    <div class="section" id="screenshots">
      <div class="h3line">
        <h3>关键截图</h3>
        <a class="permalink" href="#screenshots">#</a>
      </div>
      <div class="shots">
        <div class="shot"><a class="shot-link" href="screenshots/00_home.png" data-cap="00_home.png"><img class="thumb" src="screenshots/00_home.png" alt="shot" loading="lazy"/></a><div class="cap mono">00_home.png</div></div><div class="shot"><a class="shot-link" href="screenshots/01_all_columns.png" data-cap="01_all_columns.png"><img class="thumb" src="screenshots/01_all_columns.png" alt="shot" loading="lazy"/></a><div class="cap mono">01_all_columns.png</div></div><div class="shot"><a class="shot-link" href="screenshots/02_import_done.png" data-cap="02_import_done.png"><img class="thumb" src="screenshots/02_import_done.png" alt="shot" loading="lazy"/></a><div class="cap mono">02_import_done.png</div></div><div class="shot"><a class="shot-link" href="screenshots/03_after_import.png" data-cap="03_after_import.png"><img class="thumb" src="screenshots/03_after_import.png" alt="shot" loading="lazy"/></a><div class="cap mono">03_after_import.png</div></div><div class="shot"><a class="shot-link" href="screenshots/04_before_actions.png" data-cap="04_before_actions.png"><img class="thumb" src="screenshots/04_before_actions.png" alt="shot" loading="lazy"/></a><div class="cap mono">04_before_actions.png</div></div><div class="shot"><a class="shot-link" href="screenshots/05_action_1.png" data-cap="05_action_1.png"><img class="thumb" src="screenshots/05_action_1.png" alt="shot" loading="lazy"/></a><div class="cap mono">05_action_1.png</div></div><div class="shot"><a class="shot-link" href="screenshots/05_action_10.png" data-cap="05_action_10.png"><img class="thumb" src="screenshots/05_action_10.png" alt="shot" loading="lazy"/></a><div class="cap mono">05_action_10.png</div></div><div class="shot"><a class="shot-link" href="screenshots/05_action_11.png" data-cap="05_action_11.png"><img class="thumb" src="screenshots/05_action_11.png" alt="shot" loading="lazy"/></a><div class="cap mono">05_action_11.png</div></div><div class="shot"><a class="shot-link" href="screenshots/05_action_12.png" data-cap="05_action_12.png"><img class="thumb" src="screenshots/05_action_12.png" alt="shot" loading="lazy"/></a><div class="cap mono">05_action_12.png</div></div><div class="shot"><a class="shot-link" href="screenshots/05_action_13.png" data-cap="05_action_13.png"><img class="thumb" src="screenshots/05_action_13.png" alt="shot" loading="lazy"/></a><div class="cap mono">05_action_13.png</div></div><div class="shot"><a class="shot-link" href="screenshots/05_action_14.png" data-cap="05_action_14.png"><img class="thumb" src="screenshots/05_action_14.png" alt="shot" loading="lazy"/></a><div class="cap mono">05_action_14.png</div></div><div class="shot"><a class="shot-link" href="screenshots/05_action_15.png" data-cap="05_action_15.png"><img class="thumb" src="screenshots/05_action_15.png" alt="shot" loading="lazy"/></a><div class="cap mono">05_action_15.png</div></div><div class="shot"><a class="shot-link" href="screenshots/05_action_16.png" data-cap="05_action_16.png"><img class="thumb" src="screenshots/05_action_16.png" alt="shot" loading="lazy"/></a><div class="cap mono">05_action_16.png</div></div><div class="shot"><a class="shot-link" href="screenshots/05_action_2.png" data-cap="05_action_2.png"><img class="thumb" src="screenshots/05_action_2.png" alt="shot" loading="lazy"/></a><div class="cap mono">05_action_2.png</div></div><div class="shot"><a class="shot-link" href="screenshots/05_action_3.png" data-cap="05_action_3.png"><img class="thumb" src="screenshots/05_action_3.png" alt="shot" loading="lazy"/></a><div class="cap mono">05_action_3.png</div></div><div class="shot"><a class="shot-link" href="screenshots/05_action_4.png" data-cap="05_action_4.png"><img class="thumb" src="screenshots/05_action_4.png" alt="shot" loading="lazy"/></a><div class="cap mono">05_action_4.png</div></div><div class="shot"><a class="shot-link" href="screenshots/05_action_5.png" data-cap="05_action_5.png"><img class="thumb" src="screenshots/05_action_5.png" alt="shot" loading="lazy"/></a><div class="cap mono">05_action_5.png</div></div><div class="shot"><a class="shot-link" href="screenshots/05_action_6.png" data-cap="05_action_6.png"><img class="thumb" src="screenshots/05_action_6.png" alt="shot" loading="lazy"/></a><div class="cap mono">05_action_6.png</div></div><div class="shot"><a class="shot-link" href="screenshots/05_action_7.png" data-cap="05_action_7.png"><img class="thumb" src="screenshots/05_action_7.png" alt="shot" loading="lazy"/></a><div class="cap mono">05_action_7.png</div></div><div class="shot"><a class="shot-link" href="screenshots/05_action_8.png" data-cap="05_action_8.png"><img class="thumb" src="screenshots/05_action_8.png" alt="shot" loading="lazy"/></a><div class="cap mono">05_action_8.png</div></div><div class="shot"><a class="shot-link" href="screenshots/05_action_9.png" data-cap="05_action_9.png"><img class="thumb" src="screenshots/05_action_9.png" alt="shot" loading="lazy"/></a><div class="cap mono">05_action_9.png</div></div><div class="shot"><a class="shot-link" href="screenshots/09_after_reload.png" data-cap="09_after_reload.png"><img class="thumb" src="screenshots/09_after_reload.png" alt="shot" loading="lazy"/></a><div class="cap mono">09_after_reload.png</div></div><div class="shot"><a class="shot-link" href="screenshots/09_persist_1.png" data-cap="09_persist_1.png"><img class="thumb" src="screenshots/09_persist_1.png" alt="shot" loading="lazy"/></a><div class="cap mono">09_persist_1.png</div></div><div class="shot"><a class="shot-link" href="screenshots/09_persist_10.png" data-cap="09_persist_10.png"><img class="thumb" src="screenshots/09_persist_10.png" alt="shot" loading="lazy"/></a><div class="cap mono">09_persist_10.png</div></div><div class="shot"><a class="shot-link" href="screenshots/09_persist_11.png" data-cap="09_persist_11.png"><img class="thumb" src="screenshots/09_persist_11.png" alt="shot" loading="lazy"/></a><div class="cap mono">09_persist_11.png</div></div><div class="shot"><a class="shot-link" href="screenshots/09_persist_12.png" data-cap="09_persist_12.png"><img class="thumb" src="screenshots/09_persist_12.png" alt="shot" loading="lazy"/></a><div class="cap mono">09_persist_12.png</div></div><div class="shot"><a class="shot-link" href="screenshots/09_persist_13.png" data-cap="09_persist_13.png"><img class="thumb" src="screenshots/09_persist_13.png" alt="shot" loading="lazy"/></a><div class="cap mono">09_persist_13.png</div></div><div class="shot"><a class="shot-link" href="screenshots/09_persist_14.png" data-cap="09_persist_14.png"><img class="thumb" src="screenshots/09_persist_14.png" alt="shot" loading="lazy"/></a><div class="cap mono">09_persist_14.png</div></div><div class="shot"><a class="shot-link" href="screenshots/09_persist_15.png" data-cap="09_persist_15.png"><img class="thumb" src="screenshots/09_persist_15.png" alt="shot" loading="lazy"/></a><div class="cap mono">09_persist_15.png</div></div><div class="shot"><a class="shot-link" href="screenshots/09_persist_16.png" data-cap="09_persist_16.png"><img class="thumb" src="screenshots/09_persist_16.png" alt="shot" loading="lazy"/></a><div class="cap mono">09_persist_16.png</div></div>
      </div>
    </div>

    <div class="section" id="conclusion">
      <div class="h3line">
        <h3>结论</h3>
        <a class="permalink" href="#conclusion">#</a>
      </div>
      <div class="card">
        <p>✅ 全量校验通过（导入一致性 + 修改覆盖 + 导出一致性）</p>
      </div>
    </div>
  </div>
    </main>
  </div>

  <div id="lightbox" class="lightbox" aria-hidden="true">
    <div class="lightbox-inner">
      <div class="lightbox-top">
        <div id="lightbox-title" class="lightbox-title">screenshot</div>
        <div style="display:flex; gap:8px;">
          <button id="lightbox-open" class="lightbox-btn" type="button">在新标签页打开</button>
          <button id="lightbox-close" class="lightbox-btn" type="button">关闭 (Esc)</button>
        </div>
      </div>
      <div class="lightbox-body" id="lightbox-body">
        <img id="lightbox-img" alt="preview" />
        <div class="lightbox-nav">
          <button id="lightbox-prev" class="lightbox-btn" type="button">‹</button>
          <button id="lightbox-next" class="lightbox-btn" type="button">›</button>
        </div>
      </div>
      <div id="lightbox-cap" class="lightbox-bottom"></div>
    </div>
  </div>

  <script>
    (() => {
      // Scrollspy for the left TOC.
      const toc = document.getElementById('toc');
      const tocLinks = toc ? Array.from(toc.querySelectorAll('a[href^="#"]')) : [];
      const byId = new Map();
      tocLinks.forEach(a => {
        const id = (a.getAttribute('href') || '').slice(1);
        if (!id) return;
        byId.set(id, a);
      });
      const targets = Array.from(byId.keys()).map(id => document.getElementById(id)).filter(Boolean);
      function setActive(id) {
        tocLinks.forEach(a => a.classList.remove('active'));
        const a = byId.get(id);
        if (a) a.classList.add('active');
      }
      if (targets.length) {
        const obs = new IntersectionObserver((entries) => {
          const visible = entries.filter(e => e.isIntersecting).sort((a,b) => (b.intersectionRatio - a.intersectionRatio));
          if (!visible.length) return;
          const id = visible[0].target && visible[0].target.id;
          if (id) setActive(id);
        }, { root: null, rootMargin: '-20% 0px -70% 0px', threshold: [0.05, 0.2, 0.6] });
        targets.forEach(el => obs.observe(el));
        setActive(targets[0].id);
      }

      const links = Array.from(document.querySelectorAll('.shot-link'));
      const lb = document.getElementById('lightbox');
      const img = document.getElementById('lightbox-img');
      const title = document.getElementById('lightbox-title');
      const cap = document.getElementById('lightbox-cap');
      const btnClose = document.getElementById('lightbox-close');
      const btnOpen = document.getElementById('lightbox-open');
      const btnPrev = document.getElementById('lightbox-prev');
      const btnNext = document.getElementById('lightbox-next');
      const body = document.getElementById('lightbox-body');
      if (!lb || !img || links.length === 0) return;

      let idx = 0;
      function setIndex(i) {
        if (i < 0) i = links.length - 1;
        if (i >= links.length) i = 0;
        idx = i;
        const a = links[idx];
        const href = a.getAttribute('href') || '';
        const c = a.getAttribute('data-cap') || '';
        img.setAttribute('src', href);
        title.textContent = c || href;
        cap.textContent = href;
        btnOpen.onclick = () => window.open(href, '_blank');
      }

      function openAt(i) {
        setIndex(i);
        lb.classList.add('open');
        lb.setAttribute('aria-hidden', 'false');
      }
      function close() {
        lb.classList.remove('open');
        lb.setAttribute('aria-hidden', 'true');
        img.setAttribute('src', '');
      }

      links.forEach((a, i) => {
        a.addEventListener('click', (e) => {
          if (e.metaKey || e.ctrlKey || e.shiftKey || e.altKey) return;
          e.preventDefault();
          openAt(i);
        });
      });

      btnClose && btnClose.addEventListener('click', close);
      btnPrev && btnPrev.addEventListener('click', () => setIndex(idx - 1));
      btnNext && btnNext.addEventListener('click', () => setIndex(idx + 1));
      lb.addEventListener('click', (e) => {
        if (e.target === lb) close();
      });
      body && body.addEventListener('dblclick', close);
      document.addEventListener('keydown', (e) => {
        if (!lb.classList.contains('open')) return;
        if (e.key === 'Escape') close();
        if (e.key === 'ArrowLeft') setIndex(idx - 1);
        if (e.key === 'ArrowRight') setIndex(idx + 1);
      });
    })();
  </script>
</body>
</html>
